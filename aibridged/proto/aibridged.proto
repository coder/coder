syntax = "proto3";
option go_package = "github.com/coder/coder/v2/aibridged/proto";

package aibridged;

message TrackTokenUsageRequest {
	string session_id = 1;
	string msg_id = 2;
	int64 input_tokens = 3;
	int64 output_tokens = 4;
	string model = 5;
	map<string, int64> other = 6;
}
message TrackTokenUsageResponse {}

message TrackUserPromptRequest {
	string session_id = 1;
	string msg_id = 2;
	string prompt = 3;
	string model = 4;
}
message TrackUserPromptResponse {}

message TrackToolUsageRequest {
	string session_id = 1;
	string msg_id = 2;
	string tool = 3;
	string model = 4;
	string input = 5;
	bool injected = 6;
}
message TrackToolUsageResponse {}

// AIBridgeDaemon describes the service exposed by coderd, which allows the AI bridge to send data to coderd.
service AIBridgeDaemon {
	rpc TrackTokenUsage(TrackTokenUsageRequest) returns (TrackTokenUsageResponse);
	rpc TrackUserPrompt(TrackUserPromptRequest) returns (TrackUserPromptResponse);
	rpc TrackToolUsage(TrackToolUsageRequest) returns (TrackToolUsageResponse);
}
