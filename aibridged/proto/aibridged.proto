syntax = "proto3";
option go_package = "github.com/coder/coder/v2/aibridged/proto";

package aibridged;

message TrackTokenUsageRequest {
	string msg_id = 1;
	int64 input_tokens = 2;
	int64 output_tokens = 3;
  string model = 4;
  map<string, int64> other = 5;
}
message TrackTokenUsageResponse {}

message TrackUserPromptRequest {
	string prompt = 1;
  string model = 2;
}
message TrackUserPromptResponse {}

message TrackToolUsageRequest {
	string tool = 1;
  string model = 2;
  map<string, string> input = 3;
  bool injected = 4;
}
message TrackToolUsageResponse {}

// AIBridgeDaemon describes the service exposed by coderd, which allows the AI bridge to send data to coderd.
service AIBridgeDaemon {
	rpc TrackTokenUsage(TrackTokenUsageRequest) returns (TrackTokenUsageResponse);
	rpc TrackUserPrompt(TrackUserPromptRequest) returns (TrackUserPromptResponse);
	rpc TrackToolUsage(TrackToolUsageRequest) returns (TrackToolUsageResponse);
}
